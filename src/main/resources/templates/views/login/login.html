<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_layout}">
<body>
<div layout:fragment="content">
   
    <div class="subpage_banner" style="background-image: url(/assets/images/top_visual5.png)">
        <div class="ly_grid">
            <div class="banner_title_area">
                <h3 class="banner_title">로그인</h3>
            </div>
        </div>
    </div>

    <!-- CONTAINER -->
    <div class="container">
        <!-- CONTENT -->
        <div class="content content_login">
            <div class="ly_grid">
                <div class="card hp_bg_white">
                    <div>
                        <img th:src="@{/assets/images/subpage_login/card_icon.pn}" alt="" >
                        <div class="text_box">
                            <p class="card_title">한국언론진흥재단 미디어아카데미(KPF 미카) 방문을 환영합니다.</p>
                            <p class="card_text">모든 서비스를 이용하신 후에는 안전한 정보보호를 위해 반드시 로그아웃을 해주시기 바랍니다.</p>
                        </div>

                        <form id="loginForm" name='loginForm' action="/loginProcess" method="POST">
                            <div class="form_box">

                                <input type="text" name="username" id="floatingInput" class="common_input2" placeholder="아이디" >

                                <input type="password" name="password" id="floatingPassword" class="common_input2" placeholder="비밀번호" >
                                <input type="submit" value="로그인" class="btn_type1 btn_blue" style="border: none" >
                                <label for="floatingPassword" class="hidden_label">비밀번호</label>
                                <label for="floatingInput" class="hidden_label">아이디</label>
                            </div>
                        </form>
                    </div>
                </div>

                <ul class="member_menu">
                    <li><a href="/login/find">아이디 찾기</a></li>
                    <li><a href="/login/find?pw=true">비밀번호 찾기</a></li>
                    <li><a href="/user/join">회원가입</a></li>
                </ul>
            </div>
        </div>
    </div>
  
</div>
<th:block layout:fragment="script">
    <script th:inline="javascript">
        /* <![CDATA[ */
        $(document).ready(function (){
            $('#loginForm').submit(function (ev){
                if($('#floatingInput').val() == ''){
                    alert('아이디를 입력하세요.');
                    ev.preventDefault();
                } else if($('#floatingPassword').val() == ''){
                    alert('비밀번호를 입력하세요.');
                    ev.preventDefault();
                }
            })
        })

        window.onload = function () {

            if ([[ ${errorMessage}]]) {
                alert([[ ${errorMessage} ]]);
                if([[ ${userId} ]]) {
                    const form = document.createElement('form'); // 폼객체 생성
                    const userIdInput = document.createElement('input'); // 형식
                    userIdInput.setAttribute('type', 'text'); // type
                    userIdInput.setAttribute('name', 'userId'); // 객체이름
                    userIdInput.setAttribute('value', [[ ${userId} ]]); //객체값
                    form.appendChild(userIdInput);

                    const connectionRoot = document.createElement('input'); // 형식
                    connectionRoot.setAttribute('type', 'text'); // type
                    connectionRoot.setAttribute('name', 'joinRoot'); // 객체이름
                    connectionRoot.setAttribute('value', 'login'); //객체값
                    form.appendChild(connectionRoot);

                    form.setAttribute('method', 'post'); //get,post 가능
                    form.setAttribute('action', "/user/join/terms"); //보내는 url
                    document.body.appendChild(form);
                    form.submit();
                }
            }

            const joinForm = document.querySelector('#joinForm');
            const joinButton = document.querySelector('#joinButton');

            joinButton.addEventListener('click', function () {
                joinForm.submit();
            });
        }
        /* ]]> */
    </script>
</th:block>
<form id="joinForm" action="/anonymous/join" method="post" style="visibility: hidden"></form>
</body>
</html>
